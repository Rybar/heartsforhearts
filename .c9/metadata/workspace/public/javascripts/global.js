{"changed":true,"filter":false,"title":"global.js","tooltip":"/public/javascripts/global.js","value":"//TODO\n\n// Userlist data array for filling in info box\nvar userListData = [];\n\n// DOM Ready =============================================================\n$(document).ready(function() {\n    \n   //generateRandomSet(20);\n\n    // Populate the user table on initial page load\n    populateTable();\n\n    // Username link click\n    $('#heartList table tbody').on('click', 'td a.linkshowuser', showUserInfo);\n\n    // Add User button click\n    $('#btnAddUser').on('click', addUser);\n\n    // Delete User link click\n    $('#heartList table tbody').on('click', 'td a.linkdeleteuser', deleteUser);\n\n});\n\n// Functions =============================================================\n\n// Fill table with data\nfunction populateTable() {\n\n    // Empty content string\n    var tableContent = '';\n\n    // jQuery AJAX call for JSON\n    $.getJSON( '/users/heartlist', function( data ) {\n\n\n        // Stick our user data array into a userlist variable in the global object\n        userListData = data;\n        //console.log(userListData);\n\n        // For each item in our JSON, add a table row and cells to the content string\n        $.each(data, function(){\n            tableContent += '<tr>';\n            tableContent += '<td><a href=\"#\" class=\"linkshowuser\" rel=\"' + this._id + '\" title=\"Show Details\">' + this.fullname + '</a></td>';\n            tableContent += '<td>' + this.email + '</td>';\n            tableContent += '<td>' + this.donation + '</td>';\n            tableContent += '<td>' + this.color + '</td>';\n            tableContent += '<td>' + this.heartstyle + '</td>';\n            tableContent += '<td><a href=\"#\" class=\"linkdeleteuser\" rel=\"' + this._id + '\">delete</a></td>';\n            tableContent += '</tr>';\n        });\n\n        // Inject the whole content string into our existing HTML table\n        $('#heartList table tbody').html(tableContent);\n    });\n};\n\n// Show User Info\nfunction showUserInfo(event) {\n\n    // Prevent Link from Firing\n    event.preventDefault();\n\n    // Retrieve username from link rel attribute\n    var objectId = $(this).attr('rel');\n    //console.log($(this).attr('rel'));\n\n    // Get Index of object based on id value\n    var arrayPosition = userListData.map(function(arrayItem) { return arrayItem._id; }).indexOf(objectId);\n\n    // Get our User Object\n    var thisUserObject = userListData[arrayPosition];\n    \n    //Populate Info Box\n    $('#userInfoFullName').text(thisUserObject.fullname);\n    $('#userInfoEmail').text(thisUserObject.email);\n    $('#userInfoDonationAmount').text(thisUserObject.donation);\n    $('#userInfoInputMessage').text(thisUserObject.message);\n    $('#userInfoCurrency').text(thisUserObject.currency);\n    $('#userInfoColor').text(thisUserObject.color);\n    $('#userInfoHeartstyle').text(thisUserObject.heartstyle);\n    \n    styleHeart(thisUserObject.color, thisUserObject.heartstyle, thisUserObject.donation);\n    \n    \n};\n\n// Add User\nfunction addUser(event) {\n    event.preventDefault();\n\n    // Super basic validation - increase errorCount variable if any fields are blank\n    var errorCount = 0;\n    $('#addHeart input').each(function(index, val) {\n        if($(this).val() === '') { errorCount++; }\n    });\n\n    // Check and make sure errorCount's still at zero\n    if(errorCount === 0) {\n\n        // If it is, compile all user info into one object\n        /*\n                input#inputDonationAmount(type='text', placeholder='Donation Amount')\n                input#inputUserEmail(type='text', placeholder='Family Email')\n                input#inputUserFullname(type='text', placeholder='Full Name')\n                input#inputMessage(type='text', placeholder='Your custom message')\n                input#inputCurrency(type='text', placeholder='currency')\n                */\n        var newUser = {\n            'email': $('#addHeart fieldset input#inputUserEmail').val(),\n            'anonymous': $('#addHeart fieldset input#inputUserAnonymous').val(),\n            'fullname': $('#addHeart fieldset input#inputUserFullname').val(),\n            'initials': $('#addHeart fieldset input#inputUserInitials').val(),\n            'donation': $('#addHeart fieldset input#inputDonationAmount').val(),\n            'message': $('#addHeart fieldset input#inputMessage').val(),\n            'currency': $('#addHeart fieldset select#inputCurrency').val(),\n            'color': $('#addHeart fieldset select#inputColor').val(),\n            'heartstyle': $('#addHeart fieldset select#inputHeartstyle').val(),\n            'empty': false\n            \n        }\n\n        // Use AJAX to post the object to our adduser service\n        $.ajax({\n            type: 'POST',\n            data: newUser,\n            url: '/users/addheart',\n            dataType: 'JSON'\n        }).done(function( response ) {\n\n            // Check for successful (blank) response\n            if (response.msg === '') {\n\n                // Clear the form inputs\n                $('#addHeart fieldset input').val('');\n\n                // Update the table\n                populateTable();\n\n            }\n            else {\n\n                // If something goes wrong, alert the error message that our service returned\n                alert('Error: ' + response.msg);\n\n            }\n        });\n    }\n    else {\n        // If errorCount is more than 0, error out\n        alert('Please fill in all fields');\n        return false;\n    }\n};\n\n// Delete User\nfunction deleteUser(event) {\n\n    event.preventDefault();\n\n    // Pop up a confirmation dialog\n    var confirmation = confirm('Are you sure you want to delete this user?');\n\n    // Check and make sure the user confirmed\n    if (confirmation === true) {\n\n        // If they did, do our delete\n        $.ajax({\n            type: 'DELETE',\n            url: '/users/deleteuser/' + $(this).attr('rel')\n        }).done(function( response ) {\n\n            // Check for a successful (blank) response\n            if (response.msg === '') {\n            }\n            else {\n                alert('Error: ' + response.msg);\n            }\n\n            // Update the table\n            populateTable();\n\n        });\n\n    }\n    else {\n\n        // If they said no to the confirm, do nothing\n        return false;\n\n    }\n\n};\n\nfunction styleHeart(color, style, donationAmount){\n    var amount = parseInt(donationAmount, 10);\n    //console.log(color + \" | \" + style + \" | \" + amount);\n    var heartSize = \"small\";\n    //set size based on donationAmount\n    if(amount >= 25){\n        heartSize = 'epic';\n    }\n    else if(amount <= 20){\n        heartSize = 'xlarge';\n    }\n    else if(amount >= 15){\n        heartSize = 'large';\n    }\n     else if(amount >= 10){\n        heartSize = 'med';\n    }\n     else if(amount < 10){\n        heartSize = 'small';\n    }\n\n   // console.log(heartSize);\n    $(\"#userHeart\").find(\".heart\").removeClass();\n    $(\"#userHeart\").find(\"div\").addClass(\"heart \" + color + \" \" + heartSize);\n    $(\"#userHeart\").find(\".heart span\").text(style);\n    //$(\"#userHeart\").find(\".heart\").addClass(\"large\");\n\n}\n\n\nfunction generateRandomSet(numberOfEntries, hasEmpties) {\n    \n    for(var i = 0; i <=numberOfEntries; i++) {\n        var isEmpty = hasEmpties ? Math.random()>0.5 : false; //random chance of empty heart, or none.\n        var colors = [ 'green', 'gold', 'orange', 'red', 'pink', 'lightblue', 'blue' ],\n            styles = [ 'A', 'B', 'C', 'D', 'E','F','G', 'H', 'I', 'J', 'K', 'L', 'M' ],\n            randColor = colors[Math.floor(Math.random()*colors.length)],\n            randStyles = styles[Math.floor(Math.random()*styles.length)],\n            newUser = {\n            'email': isEmpty ? '' : chance.email(),\n            'initials': isEmpty ? '' : 'ABC',\n            'fullname' : isEmpty ? '' : chance.name(),\n            'donation': chance.integer({min: 3, max: 40}),\n            'message': isEmpty ? '' : chance.sentence(),\n            'currency': \"USD\",\n            'color': isEmpty ? 'emptyGrey' : randColor, \n            'heartstyle': isEmpty ? 'A' : randStyles,\n            'empty' : isEmpty,\n            'anonymous' : false,\n            'dedicatedName' : chance.name(),\n            'dedicatedEmail' : chance.email(),\n            'justGivingID' : \"JUSTGIVING-DONATION-ID\"\n        };\n        //console.log(randColor);\n        // Use AJAX to post the object to our adduser service\n        $.ajax({\n            type: 'POST',\n            data: newUser,\n            url: '/users/addheart',\n            dataType: 'JSON'\n        }).done(function( response ) {\n        \n            // Check for successful (blank) response\n            if (response.msg === '') {\n            }\n            else {\n        \n                // If something goes wrong, alert the error message that our service returned\n                alert('Error: ' + response.msg);\n        \n            }\n        });\n    // Clear the form inputs\n    }\n\n        // Update the table\n        populateTable();\n}","undoManager":{"mark":79,"position":87,"stack":[[{"group":"doc","deltas":[{"start":{"row":236,"column":45},"end":{"row":236,"column":46},"action":"remove","lines":["1"]},{"start":{"row":236,"column":45},"end":{"row":236,"column":46},"action":"insert","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":236,"column":53},"end":{"row":236,"column":54},"action":"remove","lines":["3"]},{"start":{"row":236,"column":53},"end":{"row":236,"column":54},"action":"insert","lines":["4"]}]}],[{"group":"doc","deltas":[{"start":{"row":241,"column":30},"end":{"row":242,"column":0},"action":"insert","lines":["",""]},{"start":{"row":242,"column":0},"end":{"row":242,"column":12},"action":"insert","lines":["            "]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":12},"end":{"row":242,"column":14},"action":"insert","lines":["''"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":13},"end":{"row":242,"column":14},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":14},"end":{"row":242,"column":15},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":15},"end":{"row":242,"column":16},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":16},"end":{"row":242,"column":17},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":17},"end":{"row":242,"column":18},"action":"insert","lines":["y"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":18},"end":{"row":242,"column":19},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":19},"end":{"row":242,"column":20},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":20},"end":{"row":242,"column":21},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":21},"end":{"row":242,"column":22},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":22},"end":{"row":242,"column":23},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":22},"end":{"row":242,"column":23},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":23},"end":{"row":242,"column":24},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":24},"end":{"row":242,"column":25},"action":"insert","lines":[":"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":25},"end":{"row":242,"column":26},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":26},"end":{"row":242,"column":27},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":27},"end":{"row":242,"column":28},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":28},"end":{"row":242,"column":29},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":29},"end":{"row":242,"column":30},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":30},"end":{"row":242,"column":31},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":31},"end":{"row":242,"column":32},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":31},"end":{"row":242,"column":32},"action":"remove","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":31},"end":{"row":242,"column":32},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":242,"column":32},"end":{"row":243,"column":0},"action":"insert","lines":["",""]},{"start":{"row":243,"column":0},"end":{"row":243,"column":12},"action":"insert","lines":["            "]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":12},"end":{"row":243,"column":14},"action":"insert","lines":["''"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":13},"end":{"row":243,"column":14},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":14},"end":{"row":243,"column":15},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":15},"end":{"row":243,"column":16},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":16},"end":{"row":243,"column":17},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":17},"end":{"row":243,"column":18},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":13},"end":{"row":243,"column":18},"action":"remove","lines":["dedic"]},{"start":{"row":243,"column":13},"end":{"row":243,"column":26},"action":"insert","lines":["dedicatedName"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":27},"end":{"row":243,"column":28},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":28},"end":{"row":243,"column":29},"action":"insert","lines":[":"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":29},"end":{"row":243,"column":30},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":30},"end":{"row":243,"column":31},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":31},"end":{"row":243,"column":32},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":32},"end":{"row":243,"column":33},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":33},"end":{"row":243,"column":34},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":34},"end":{"row":243,"column":35},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":35},"end":{"row":243,"column":36},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":36},"end":{"row":243,"column":37},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":37},"end":{"row":243,"column":38},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":38},"end":{"row":243,"column":39},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":39},"end":{"row":243,"column":40},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":40},"end":{"row":243,"column":41},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":41},"end":{"row":243,"column":43},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":43},"end":{"row":243,"column":44},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":44},"end":{"row":244,"column":0},"action":"insert","lines":["",""]},{"start":{"row":244,"column":0},"end":{"row":244,"column":12},"action":"insert","lines":["            "]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":12},"end":{"row":244,"column":14},"action":"insert","lines":["''"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":13},"end":{"row":244,"column":14},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":14},"end":{"row":244,"column":15},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":15},"end":{"row":244,"column":16},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":16},"end":{"row":244,"column":17},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":13},"end":{"row":244,"column":17},"action":"remove","lines":["dedi"]},{"start":{"row":244,"column":13},"end":{"row":244,"column":27},"action":"insert","lines":["dedicatedEmail"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":28},"end":{"row":244,"column":29},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":29},"end":{"row":244,"column":30},"action":"insert","lines":[":"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":30},"end":{"row":244,"column":31},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":31},"end":{"row":244,"column":32},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":32},"end":{"row":244,"column":33},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":33},"end":{"row":244,"column":34},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":34},"end":{"row":244,"column":35},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":35},"end":{"row":244,"column":36},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":36},"end":{"row":244,"column":37},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":37},"end":{"row":244,"column":38},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":38},"end":{"row":244,"column":39},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":39},"end":{"row":244,"column":40},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":40},"end":{"row":244,"column":41},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":41},"end":{"row":244,"column":42},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":42},"end":{"row":244,"column":43},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":43},"end":{"row":244,"column":45},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":45},"end":{"row":244,"column":46},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":43},"end":{"row":243,"column":44},"action":"remove","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":243,"column":43},"end":{"row":243,"column":44},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":44},"end":{"row":244,"column":45},"action":"remove","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":44},"end":{"row":244,"column":45},"action":"insert","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":45},"end":{"row":244,"column":46},"action":"remove","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":244,"column":45},"end":{"row":244,"column":46},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":115,"column":75},"end":{"row":115,"column":76},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":115,"column":76},"end":{"row":115,"column":77},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":115,"column":77},"end":{"row":115,"column":78},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":115,"column":78},"end":{"row":115,"column":79},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":115,"column":78},"end":{"row":115,"column":79},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":115,"column":77},"end":{"row":115,"column":78},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":115,"column":76},"end":{"row":115,"column":77},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":115,"column":75},"end":{"row":115,"column":76},"action":"remove","lines":["f"]}]}]]},"ace":{"folds":[],"scrolltop":1620,"scrollleft":0,"selection":{"start":{"row":115,"column":75},"end":{"row":115,"column":75},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":94,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1428545640000}