{"changed":true,"filter":false,"title":"app.js","tooltip":"/app.js","value":"var express = require('express');\nvar path = require('path');\nvar favicon = require('serve-favicon');\nvar logger = require('morgan');\nvar cookieParser = require('cookie-parser');\nvar bodyParser = require('body-parser');\n// Database\nvar mongo = require('mongoskin');\n\nif (process.env.NODE_ENV == \"production\") {\n  var db = ( process.env.DATABASE_URL, {native_parser:true} );\n}\nelse {\nvar db = mongo.db(\"mongodb://localhost:27017/heartsDB\", {native_parser:true});\n}\n\n//var db = mongo.db(\"mongodb://localhost:27017/heartsDB\", {native_parser:true});\n\nvar routes = require('./routes/index');\nvar users = require('./routes/users');\n\nvar app = express();\n\n// view engine setup\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'jade');\n\n// uncomment after placing your favicon in /public\n//app.use(favicon(__dirname + '/public/favicon.ico'));\napp.use(logger('dev'));\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded());\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, 'public')));\n\n// Make our db accessible to our router\napp.use(function(req,res,next){\n    req.db = db;\n    next();\n});\n\napp.use('/', routes);\napp.use('/users', users);\n\n/// catch 404 and forwarding to error handler\napp.use(function(req, res, next) {\n    var err = new Error('Not Found');\n    err.status = 404;\n    next(err);\n});\n\n/// error handlers\n\n// development error handler\n// will print stacktrace\nif (app.get('env') === 'development') {\n    app.use(function(err, req, res, next) {\n        res.status(err.status || 500);\n        res.render('error', {\n            message: err.message,\n            error: err\n        });\n    });\n}\n\n// production error handler\n// no stacktraces leaked to user\napp.use(function(err, req, res, next) {\n    res.status(err.status || 500);\n    res.render('error', {\n        message: err.message,\n        error: {}\n    });\n});\n\n\nmodule.exports = app;\n","undoManager":{"mark":15,"position":18,"stack":[[{"group":"doc","deltas":[{"start":{"row":8,"column":51},"end":{"row":8,"column":53},"action":"insert","lines":["DB"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":33},"end":{"row":8,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":0},"end":{"row":9,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":0},"end":{"row":10,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":0},"end":{"row":16,"column":1},"action":"insert","lines":["if (process.env.NODE_ENV == \"production\") ","{","  //","}","else if ((process.env.NODE_ENV == \"development\") ","{","","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":42},"end":{"row":10,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":12,"column":5},"end":{"row":13,"column":0},"action":"remove","lines":["if ((process.env.NODE_ENV == \"development\") ",""]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":0},"end":{"row":14,"column":0},"action":"insert","lines":["var db = mongo.db(\"mongodb://localhost:27017/heartsDB\", {native_parser:true});",""]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":4},"end":{"row":10,"column":82},"action":"insert","lines":["var db = mongo.db(\"mongodb://localhost:27017/heartsDB\", {native_parser:true});"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":2},"end":{"row":10,"column":3},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":2},"end":{"row":10,"column":3},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":11},"end":{"row":10,"column":56},"action":"remove","lines":["mongo.db(\"mongodb://localhost:27017/heartsDB\""]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":11},"end":{"row":10,"column":35},"action":"insert","lines":["process.env.DATABASE_URL"]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":11},"end":{"row":10,"column":12},"action":"insert","lines":["("]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":12},"end":{"row":10,"column":13},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":10,"column":59},"end":{"row":10,"column":60},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":0},"end":{"row":17,"column":1},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":1},"end":{"row":17,"column":2},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":13,"column":78},"end":{"row":14,"column":0},"action":"remove","lines":["",""]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":7,"column":33},"end":{"row":7,"column":33},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1427601058035}